<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>disclojure.gateway documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Disclojure</span> <span class="project-version">Indev</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>disclojure</span></div></div></li><li class="depth-2 branch"><a href="disclojure.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch current"><a href="disclojure.gateway.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gateway</span></div></a></li><li class="depth-2 branch"><a href="disclojure.info.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>info</span></div></a></li><li class="depth-2"><a href="disclojure.rest.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rest</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="disclojure.gateway.html#var-connect"><div class="inner"><span>connect</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-disconnect"><div class="inner"><span>disconnect</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-gate-ops"><div class="inner"><span>gate-ops</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-gateway-endp"><div class="inner"><span>gateway-endp</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-gateway-url"><div class="inner"><span>gateway-url</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-get-op"><div class="inner"><span>get-op</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-on-receive"><div class="inner"><span>on-receive</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-reconnect"><div class="inner"><span>reconnect</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-set-heartbeat"><div class="inner"><span>set-heartbeat</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-set-interval"><div class="inner"><span>set-interval</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-sset"><div class="inner"><span>sset</span></div></a></li><li class="depth-1"><a href="disclojure.gateway.html#var-ws-send"><div class="inner"><span>ws-send</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">disclojure.gateway</h1><div class="doc"><pre class="plaintext">The main gateway implementation for Disclojure.
</pre></div><div class="public anchor" id="var-connect"><h3>connect</h3><div class="usage"><code>(connect token)</code><code>(connect token resume?)</code><code>(connect token resume? sdefs)</code></div><div class="doc"><pre class="plaintext">Creates a new session and connects to the gateway.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L59">view source</a></div></div><div class="public anchor" id="var-disconnect"><h3>disconnect</h3><div class="usage"><code>(disconnect session)</code></div><div class="doc"><pre class="plaintext">FIXME: Document this!</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L89">view source</a></div></div><div class="public anchor" id="var-gate-ops"><h3>gate-ops</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A map from raw numeric opcodes to their keyword equivalents.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L123">view source</a></div></div><div class="public anchor" id="var-gateway-endp"><h3>gateway-endp</h3><div class="usage"></div><div class="doc"><pre class="plaintext">FIXME: Document this!</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L15">view source</a></div></div><div class="public anchor" id="var-gateway-url"><h3>gateway-url</h3><div class="usage"></div><div class="doc"><pre class="plaintext">Retrieves the URL that should be used to connect to the gateway.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L16">view source</a></div></div><div class="public anchor" id="var-get-op"><h3>get-op</h3><div class="usage"></div><div class="doc"><pre class="plaintext">A map from keyword opcodes to their raw numeric equivalents.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L137">view source</a></div></div><div class="public anchor" id="var-on-receive"><h3>on-receive</h3><div class="usage"><code>(on-receive session ws msg)</code></div><div class="doc"><pre class="plaintext">Called on receiving a message from the websocket.
Handles:
  - Event sequence tracking
  - Dispatching events to the function given in the session's :dispatch key
  - Setting up and maintaining heartbeats
  - Receiving and processing reconnect and invalid session messages.</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L24">view source</a></div></div><div class="public anchor" id="var-reconnect"><h3>reconnect</h3><div class="usage"><code>(reconnect session)</code><code>(reconnect session resume?)</code></div><div class="doc"><pre class="plaintext">Attempts to reconnect the given session.
Attempts to resume by default, otherwise reidentifies from scratch.</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L95">view source</a></div></div><div class="public anchor" id="var-set-heartbeat"><h3>set-heartbeat</h3><div class="usage"><code>(set-heartbeat session)</code><code>(set-heartbeat session now?)</code></div><div class="doc"><pre class="plaintext">Creates a timer to send heartbeats at the proper intervals.
Checks for acks and attempts to reconnect if the last ack was not recieved.</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L110">view source</a></div></div><div class="public anchor" id="var-set-interval"><h3>set-interval</h3><div class="usage"><code>(set-interval callback ms)</code><code>(set-interval callback ms now?)</code></div><div class="doc"><pre class="plaintext">Utility function for running a function at set intervals.
If now? is true, the function will be run immediately the first time.</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L163">view source</a></div></div><div class="public anchor" id="var-sset"><h3>sset</h3><div class="usage"><code>(sset session &amp; args)</code></div><div class="doc"><pre class="plaintext">Utility function for updating fields on the given session.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L176">view source</a></div></div><div class="public anchor" id="var-ws-send"><h3>ws-send</h3><div class="usage"><code>(ws-send socket msg)</code></div><div class="doc"><pre class="plaintext">Converts the given message to JSON and sends it over the given socket.
</pre></div><div class="src-link"><a href="https://github.com/tripl3dogdare/disclojure/blob/master/src/disclojure/gateway.clj#L172">view source</a></div></div></div></body></html>